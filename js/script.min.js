var link=document.querySelector(".contacts-button"),modal=document.querySelector(".modal-feedback"),overlay=document.querySelector(".overlay"),close=document.querySelector(".modal-close"),form=document.querySelector(".feedback-form"),username=document.getElementById("feedback-name"),email=document.getElementById("feedback-email"),text=document.getElementById("feedback-text"),isStorageSupport=!0,storage="";try{storage=localStorage.getItem("username"),storage=localStorage.getItem("email")}catch(e){isStorageSupport=!1}link&&link.addEventListener("click",function(e){e.preventDefault(),modal.classList.add("modal-show"),overlay.classList.add("overlay-show"),storage?(username.value=storage,email.value=storage,text.focus()):username.focus()}),close&&close.addEventListener("click",function(e){e.preventDefault(),modal.classList.remove("modal-show"),modal.classList.remove("modal-error"),overlay.classList.remove("overlay-show")}),overlay&&overlay.addEventListener("click",function(e){e.preventDefault(),modal.classList.remove("modal-show"),modal.classList.remove("modal-error"),overlay.classList.remove("overlay-show")}),form&&form.addEventListener("submit",function(e){username.value&&email.value&&text.value?isStorageSupport&&(localStorage.setItem("username",username.value),localStorage.setItem("email",email.value)):(e.preventDefault(),modal.classList.remove("modal-error"),modal.offsetWidth=modal.offsetWidth,modal.classList.add("modal-error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),modal.classList.contains("modal-show")&&(modal.classList.remove("modal-show"),modal.classList.remove("modal-error"),overlay.classList.remove("overlay-show")))});var searchLink=document.querySelector(".search-link-trigger"),searchPopup=document.querySelector(".search-link-tooltip"),searchForm=searchPopup.querySelector("form"),search=searchPopup.querySelector("[name=search]");searchLink.addEventListener("mouseover",function(e){search.focus()}),searchForm.addEventListener("submit",function(e){search.value||(e.preventDefault(),searchPopup.classList.remove("popup-error"),searchPopup.offsetWidth=modal.offsetWidth,searchPopup.classList.add("popup-error"))});var loginLink=document.querySelector(".login-link-trigger"),loginPopup=document.querySelector(".login-link-tooltip"),loginForm=loginPopup.querySelector("form"),login=loginPopup.querySelector("[name=login]"),password=loginPopup.querySelector("[name=password]");try{storage=localStorage.getItem("login")}catch(e){isStorageSupport=!1}loginLink.addEventListener("mouseover",function(e){storage?(login.value=storage,password.focus()):login.focus()}),loginForm.addEventListener("submit",function(e){login.value&&password.value?isStorageSupport&&localStorage.setItem("login",login.value):(e.preventDefault(),loginPopup.classList.remove("popup-error"),loginPopup.offsetWidth=modal.offsetWidth,loginPopup.classList.add("popup-error"))});var select=document.querySelector(".filter-select"),selectArrow=document.querySelector(".select-arrow");function initMap(){var e={center:new google.maps.LatLng(59.939367,30.329416),zoom:16},o=new google.maps.Map(document.querySelector(".map"),e),t=new google.maps.LatLng(59.938827,30.323073),a=!(!navigator.userAgent.match(/Trident/)||!navigator.userAgent.match(/rv[ :]11/));new google.maps.Marker({position:t,map:o,title:"ул. Большая Конюшенная 19/8, Санкт-Петербург",icon:a?"img/pin.png":"img/pin.svg"})}select&&(select.addEventListener("focus",function(e){select.classList.add("select-active"),selectArrow.classList.add("arrow-active")}),select.addEventListener("blur",function(e){select.classList.remove("select-active"),selectArrow.classList.remove("arrow-active")})),google.maps.event.addDomListener(window,"load",initMap);